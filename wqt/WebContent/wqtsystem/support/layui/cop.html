<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="plugins/layui/css/layui.css" media="all" />
	<script>
            //百度自动推送代码
            (function(){
                var bp = document.createElement('script');
                var curProtocol = window.location.protocol.split(':')[0];
                if (curProtocol === 'https') {
                    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                }
                else {
                    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                }
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(bp, s);
            })();
            //百度统计代码
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?42488dceee05409d65f7bf2d164133d9";
              var s = document.getElementsByTagName("script")[0]; 
              s.parentNode.insertBefore(hm, s);
            })();
            //360浏览器推送代码
            (function(){
              var src = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?7333e036a851641d0a404fac1617c6de":"https://jspassport.ssl.qhimg.com/11.0.1.js?7333e036a851641d0a404fac1617c6de";
                  document.write('<script src="' + src + '" id="sozz"><\/script>');
            })();
        </script>
    </head>
    <body>
        <script>
            //百度信誉代码
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?3d82d1abf6ac0fc3c192d9c07c32fa89";
              var s = document.getElementsByTagName("script")[0]; 
              s.parentNode.insertBefore(hm, s);
            })();
        </script>
		<div style="width: 400px;margin: 0 auto;"><button id="add" class="layui-btn">向选项卡添加一个tab</button></div>

		<script type="text/javascript" src="plugins/layui/layui.js"></script>
		<script>
			//循环获取父层的tab对象，为什么用循环呢？因为子层加载完，父层还不一定加载完了。所以获取到的是undefined
			/*var index = setInterval(function() {
				if(typeof parent.tab !== 'undefined') {
					//如果获取到tab对象，则停止循环
					clearInterval(index);
					//通过调用父层的tab组件里的tabAdd方法添加一个tab选项卡
					parent.tab.tabAdd({
						href: 'https://www.baidu.com', //地址
						icon: 'fa-user',
						title: '这是在子窗口打开的tab选项卡'
					});
				}
			}, 20);*/
			//如果需要在些页面上获取到父页面的变量，需要把变量设置为全局，
			/**
			 * 例：
			 * var tab;
			 * layui.use('tab',function(){
			 * 	   tab = layui.tab(setting);
			 * });
			 */
			//上面那个是页面渲染完就添加的
			layui.use(['layer'], function() {
				var $ = layui.jquery,
					layer = layui.layer;

				//这个是点击之后才添加的。
				$('#add').on('click', function() {
					var con = '<div style="padding:10px;"><input type="text" class="layui-input" style="margin-bottom:5px;" name="url" placeholder="地址" />'+
					'<input type="text" class="layui-input" style="margin-bottom:5px;" name="title" placeholder="标题" />'+
					'<input type="text" class="layui-input" name="icon" placeholder="图标" /></div>';
						
						layer.open({
							type: 1,
							title: '确认框',
							content: con,
							btn: ['确定', '取消'],
							area: ['350px', '250px'],
							yes: function(index, layero) {
								//这是核心的代码。
								parent.tab.tabAdd({
									href: $(layero).find('input[name=url]').val(), //地址
									icon: $(layero).find('input[name=icon]').val(),
									title: $(layero).find('input[name=title]').val()
								});
							},
							shade :false,
							maxmin :true
						});

				});

			});
		</script>
	</body>

</html>